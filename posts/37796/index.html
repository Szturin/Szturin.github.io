<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>【卡尔曼滤波】[1]理论基础入门 | Turin's Blog</title><meta name="author" content="Szturin"><meta name="copyright" content="Szturin"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="1. 状态空间表达式 Wk：过程噪声 Vk：观测噪声   2. 系统框图   3. 高斯分布 卡尔曼滤波的噪声分布为高斯分布 4  Wk,Q k的定义： 举个栗子： 一辆以大约5m&#x2F;s行驶的小车，收到各种阻力的影响，运动速度为 V+Vr 实际速度为：5+ δ (m&#x2F;s) Wk &#x3D; δ m&#x2F;s δ ∈ N(0;1)的高斯分布，Qk &#x3D; 1  4. 协方差  Δ11就是cov(x1,x2)的简化形式">
<meta property="og:type" content="article">
<meta property="og:title" content="【卡尔曼滤波】[1]理论基础入门">
<meta property="og:url" content="https://szturin.github.io/posts/37796/index.html">
<meta property="og:site_name" content="Turin&#39;s Blog">
<meta property="og:description" content="1. 状态空间表达式 Wk：过程噪声 Vk：观测噪声   2. 系统框图   3. 高斯分布 卡尔曼滤波的噪声分布为高斯分布 4  Wk,Q k的定义： 举个栗子： 一辆以大约5m&#x2F;s行驶的小车，收到各种阻力的影响，运动速度为 V+Vr 实际速度为：5+ δ (m&#x2F;s) Wk &#x3D; δ m&#x2F;s δ ∈ N(0;1)的高斯分布，Qk &#x3D; 1  4. 协方差  Δ11就是cov(x1,x2)的简化形式">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://api.aqcoder.cn/random">
<meta property="article:published_time" content="2024-12-03T02:39:36.000Z">
<meta property="article:modified_time" content="2024-12-20T20:06:09.452Z">
<meta property="article:author" content="Szturin">
<meta property="article:tag" content="算法 计算机语言 机器人 单片机 EDA 电子技术学习">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://api.aqcoder.cn/random"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://szturin.github.io/posts/37796/index.html"><link rel="preconnect" href="//unpkg.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://unpkg.com/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://unpkg.com/@fancyapps/ui/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'mediumZoom',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://unpkg.com/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '【卡尔曼滤波】[1]理论基础入门',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-12-21 04:06:09'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-footer-beautify@1.0.0/lib/runtime.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="Turin's Blog" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">86</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">51</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">34</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-bookmark"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/share/"><i class="fa-fw fa fa-share-alt-square"></i><span> 分享</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fa fa-images"></i><span> 图库</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于我</span></a></div><div class="menus_item"><a class="site-page" href="/notebook/"><i class="fa-fw comment-alt-smile"></i><span> 笔记</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://api.aqcoder.cn/random')"><nav id="nav"><span id="blog-info"><a href="/" title="Turin's Blog"><span class="site-name">Turin's Blog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-bookmark"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/share/"><i class="fa-fw fa fa-share-alt-square"></i><span> 分享</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fa fa-images"></i><span> 图库</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于我</span></a></div><div class="menus_item"><a class="site-page" href="/notebook/"><i class="fa-fw comment-alt-smile"></i><span> 笔记</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">【卡尔曼滤波】[1]理论基础入门<a class="post-edit-link" href="null_posts/【卡尔曼滤波】-1-理论基础入门.md" title="编辑" target="_blank"><i class="fas fa-pencil-alt"></i></a></h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-12-03T02:39:36.000Z" title="发表于 2024-12-03 10:39:36">2024-12-03</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-12-20T20:06:09.452Z" title="更新于 2024-12-21 04:06:09">2024-12-21</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">8.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>29分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="【卡尔曼滤波】[1]理论基础入门"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="1-状态空间表达式"><a class="markdownIt-Anchor" href="#1-状态空间表达式"></a> 1. 状态空间表达式</h2>
<p>Wk：过程噪声</p>
<p>Vk：观测噪声</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="/posts/37796/image-20241203184424713.png" class="" title="image-20241203184424713">
<h2 id="2-系统框图"><a class="markdownIt-Anchor" href="#2-系统框图"></a> 2. 系统框图</h2>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="/posts/37796/image-20241203185305821.png" class="" title="image-20241203185305821">
<h2 id="3-高斯分布"><a class="markdownIt-Anchor" href="#3-高斯分布"></a> 3. 高斯分布</h2>
<p>卡尔曼滤波的噪声分布为高斯分布</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="/posts/37796/image-20241203185443689.png" class="" title="image-20241203185443689">4
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="/posts/37796/image-20241203190029824.png" class="" title="image-20241203190029824">
<p>Wk,Q k的定义：</p>
<p>举个栗子：</p>
<p>一辆以<mark>大约</mark>5m/s行驶的小车，收到各种阻力的影响，运动速度为 V+Vr</p>
<p>实际速度为：5+ δ (m/s)</p>
<p>Wk = δ m/s</p>
<p>δ ∈ N(0;1)的高斯分布，Qk = 1</p>
<h2 id="4-协方差"><a class="markdownIt-Anchor" href="#4-协方差"></a> 4. 协方差</h2>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="/posts/37796/image-20241203191925230.png" class="" title="image-20241203191925230">
<p>Δ11就是cov(x1,x2)的简化形式</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="/posts/37796/image-20241203190837390.png" class="" title="image-20241203190837390">
<blockquote>
<h1 id="二维协方差"><a class="markdownIt-Anchor" href="#二维协方差"></a> 二维协方差</h1>
<p>二维协方差（或称为协方差矩阵）是一个扩展了标准协方差概念的工具，适用于多维数据，特别是用于描述两个或更多变量之间的关系。在二维情况下，协方差矩阵可以用于表示两个随机变量 (X) 和 (Y) 的联合分布中的协方差。</p>
<h2 id="协方差矩阵的表示"><a class="markdownIt-Anchor" href="#协方差矩阵的表示"></a> 协方差矩阵的表示</h2>
<p>对于二维数据 ((X, Y))，协方差矩阵表示为：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="/posts/37796/image-20241203192007207.png" class="" title="image-20241203192007207">
<p>其中：</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mi>o</mi><mi>v</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Cov(X, X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span> 是 (X) 的方差，表示 (X) 自身的波动程度。</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mi>o</mi><mi>v</mi><mo stretchy="false">(</mo><mi>Y</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Cov(Y, Y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span> 是 (Y) 的方差，表示 (Y) 自身的波动程度。</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mi>o</mi><mi>v</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Cov(X, Y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span> 是 (X) 和 (Y) 之间的协方差，表示它们之间的线性关系。</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mi>o</mi><mi>v</mi><mo stretchy="false">(</mo><mi>Y</mi><mo separator="true">,</mo><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Cov(Y, X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span> 与 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mi>o</mi><mi>v</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Cov(X, Y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span> 相等，因为协方差是对称的。</li>
</ul>
<p>因此，二维协方差矩阵包含了两个变量的方差和它们之间的协方差。协方差矩阵的对角线元素是方差，非对角线元素是协方差。对于一个具有多个维度的变量，协方差矩阵扩展至更大的尺寸，以此方式描述多个变量之间的关系。</p>
<h2 id="二维协方差矩阵的计算"><a class="markdownIt-Anchor" href="#二维协方差矩阵的计算"></a> 二维协方差矩阵的计算</h2>
<p>假设有以下数据集 (X = [x_1, x_2, …, x_n]) 和 (Y = [y_1, y_2, …, y_n])，则二维协方差矩阵的计算可以按以下步骤进行：</p>
<ol>
<li>
<p>计算每个变量的均值$ \overline{X}$ 和 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>Y</mi><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\overline{Y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8833300000000001em;vertical-align:0em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833300000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span><span style="top:-3.80333em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span></span></span></span>。</p>
</li>
<li>
<p>计算每对变量之间的协方差，使用公式</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext>Cov</mtext><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo>−</mo><mover accent="true"><mi>X</mi><mo stretchy="true">‾</mo></mover><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>−</mo><mover accent="true"><mi>Y</mi><mo stretchy="true">‾</mo></mover><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Cov}(X, Y) = \frac{1}{n} \sum_{i=1}^{n} (X_i - \overline{X})(Y_i - \overline{Y})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Cov</span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.13333em;vertical-align:-0.25em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833300000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span><span style="top:-3.80333em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.13333em;vertical-align:-0.25em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833300000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span><span style="top:-3.80333em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
</li>
<li>
<p>构建协方差矩阵。</p>
</li>
</ol>
<h2 id="应用"><a class="markdownIt-Anchor" href="#应用"></a> 应用</h2>
<p>二维协方差矩阵在以下领域有广泛应用：</p>
<ul>
<li>多元统计分析</li>
<li>机器学习算法（如主成分分析）</li>
<li>金融分析</li>
</ul>
</blockquote>
<h2 id="5-超参数"><a class="markdownIt-Anchor" href="#5-超参数"></a> 5. 超参数</h2>
<p>卡尔曼滤波器主要调节两个参数：</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Q</span></span></span></span>：过程噪声的方差</p>
<p>R$：观测噪声的方差</p>
<h1 id="卡尔曼滤波"><a class="markdownIt-Anchor" href="#卡尔曼滤波"></a> 卡尔曼滤波</h1>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="/posts/37796/image-20241203192438759.png" class="" title="image-20241203192438759">
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">X_{k-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>：最优估计值，后验，就是卡尔曼滤波器的输出值</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mrow><mi>k</mi><mo>−</mo></mrow></msub></mrow><annotation encoding="application/x-tex">X_{k-}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mord mtight">−</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>：基于Xk-1的估计值，先验估计值</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">y_{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ：传感器的测量值，当前时刻的观测值</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="/posts/37796/image-20241203192744409.png" class="" title="image-20241203192744409">
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">X_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>：当前的最优估计值</p>
<p>当前的最优估计值可以理解为<strong>先验估计值</strong>和<strong>测量值</strong>重合相关得到的结果。</p>
<h1 id="卡尔曼滤波-2"><a class="markdownIt-Anchor" href="#卡尔曼滤波-2"></a> 卡尔曼滤波</h1>
<h2 id="一-实现过程"><a class="markdownIt-Anchor" href="#一-实现过程"></a> 一、实现过程</h2>
<p>使用上一次的最优结果，预测当前的值，同时用<mark>观测值</mark>修正当前值，得到<mark>最优结果</mark>。</p>
<p>​</p>
<hr>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">@对理想的一维匀加速直线运动模型，配有不精确的imu和不精确的gps，进行位置观测，协方差均使用矩阵的方式表示，以适配多维特征</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">t = np.linspace(<span class="number">1</span>,<span class="number">100</span>,<span class="number">100</span>) <span class="comment"># 在1~100s内采样100次</span></span><br><span class="line">u = <span class="number">0.6</span> <span class="comment"># 加速度值，匀加速直线运动模型</span></span><br><span class="line">v0 = <span class="number">5</span> <span class="comment"># 初始速度</span></span><br><span class="line">s0 = <span class="number">0</span> <span class="comment"># 初始位置</span></span><br><span class="line">X_true = np.array([[s0], [v0]])</span><br><span class="line">size = t.shape[<span class="number">0</span>] + <span class="number">1</span></span><br><span class="line">dims = <span class="number">2</span> <span class="comment"># x, v, [位置, 速度]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 这两个参数可以理解为Q：对测量器的信任度 R：对系统模型的信任度</span></span><br><span class="line">Q = np.array([[<span class="number">1e1</span>,<span class="number">0</span>], [<span class="number">0</span>,<span class="number">1e1</span>]]) <span class="comment"># 过程噪声的协方差矩阵，这是一个超参数</span></span><br><span class="line">R = np.array([[<span class="number">1e10</span>,<span class="number">0</span>], [<span class="number">0</span>,<span class="number">1e10</span>]]) <span class="comment"># 观测噪声的协方差矩阵，也是一个超参数。</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># R_var = R.trace()</span></span><br><span class="line"><span class="comment"># 初始化</span></span><br><span class="line">X = np.array([[<span class="number">0</span>], [<span class="number">0</span>]]) <span class="comment"># 估计的初始状态，[位置, 速度]，就是我们要估计的内容，可以用v0，s0填入，也可以默认为0，相差越大，收敛时间越长</span></span><br><span class="line">P = np.array([[<span class="number">0.1</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">0.1</span>]]) <span class="comment"># 先验误差协方差矩阵的初始值，根据经验给出</span></span><br><span class="line"><span class="comment"># 已知的线性变换矩阵</span></span><br><span class="line">F = np.array([[<span class="number">1</span>, <span class="number">1</span>], [<span class="number">0</span>, <span class="number">1</span>]]) <span class="comment"># 状态转移矩阵</span></span><br><span class="line">B = np.array([[<span class="number">1</span>/<span class="number">2</span>], [<span class="number">1</span>]]) <span class="comment"># 控制矩阵</span></span><br><span class="line">H = np.array([[<span class="number">1</span>,<span class="number">0</span>],[<span class="number">0</span>,<span class="number">1</span>]]) <span class="comment"># 观测矩阵</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据理想模型推导出来的真实位置值，实际生活中不会存在如此简单的运动模型，真实位置也不可知，本程序中使用真值的目的是模拟观测噪声数据和测量噪声数据</span></span><br><span class="line"><span class="comment"># 对于实际应用的卡尔曼滤波而言，并不需要知道真实值，而是通过预测值和观测值，来求解最优估计值，从而不断逼近该真值</span></span><br><span class="line">real_positions = np.array([<span class="number">0</span>] * size) <span class="comment"># 这样写的目的是为了创建长序列，用于绘制整个运动过程的图像</span></span><br><span class="line">real_speeds = np.array([<span class="number">0</span>] * size) <span class="comment"># 后面要使用for循环，而for循环中需要用到i，而i是索引，所以需要创建一个长度为size的数组，用于存储每个时刻的位置和速度</span></span><br><span class="line">real_positions[<span class="number">0</span>] = s0 <span class="comment"># 初始时刻的位置</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 实际观测值，通过理论值加上观测噪声模拟获得，初值即理论初始点加上观测噪声</span></span><br><span class="line">measure_positions = np.array([<span class="number">0</span>] * size)</span><br><span class="line">measure_speeds = np.array([<span class="number">0</span>] * size)</span><br><span class="line">measure_positions[<span class="number">0</span>] = real_positions[<span class="number">0</span>] + np.random.normal(<span class="number">0</span>, R[<span class="number">0</span>][<span class="number">0</span>]**<span class="number">0.5</span>)</span><br><span class="line"><span class="comment"># 最优估计值，也就是卡尔曼滤波输出的真实值的近似逼近，同样地，初始值由观测值决定</span></span><br><span class="line">optim_positions = np.array([<span class="number">0</span>] * size)</span><br><span class="line">optim_positions[<span class="number">0</span>] = measure_positions[<span class="number">0</span>]</span><br><span class="line">optim_speeds = np.array([<span class="number">0</span>] * size)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,t.shape[<span class="number">0</span>]+<span class="number">1</span>):</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 根据理想模型获得当前的速度、位置真实值（实际应用中不需要），程序中只是为了模拟测试值和比较</span></span><br><span class="line">    w = np.array([[np.random.normal(<span class="number">0</span>, Q[<span class="number">0</span>][<span class="number">0</span>]**<span class="number">0.5</span>)], [np.random.normal(<span class="number">0</span>, Q[<span class="number">1</span>][<span class="number">1</span>]**<span class="number">0.5</span>)]]) <span class="comment"># 过程噪声协方差矩阵</span></span><br><span class="line">    X_true = F @ X_true + B * u + w</span><br><span class="line">    real_positions[i] = X_true[<span class="number">0</span>]</span><br><span class="line">    real_speeds[i] = X_true[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    v = np.array([[np.random.normal(<span class="number">0</span>, R[<span class="number">0</span>][<span class="number">0</span>]**<span class="number">0.5</span>)], [np.random.normal(<span class="number">0</span>, R[<span class="number">1</span>][<span class="number">1</span>]**<span class="number">0.5</span>)]]) <span class="comment"># 观测噪声协方差矩阵</span></span><br><span class="line">    <span class="comment"># 观测矩阵用于产生真实的观测数据，注意各量之间的关联</span></span><br><span class="line">    Z = H @ X_true + v</span><br><span class="line">    <span class="comment"># 以下是卡尔曼滤波的整个过程</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 预测</span></span><br><span class="line">    X_ = F @ X + B * u      <span class="comment"># 预测方程</span></span><br><span class="line">    P_ = F @ P @ F.T + Q    <span class="comment"># 预测协方差矩阵</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 更新</span></span><br><span class="line">    <span class="comment"># 注意矩阵运算的顺序</span></span><br><span class="line">    K = P_@ H.T @ np.linalg.inv(H @ P_@ H.T + R) <span class="comment"># 计算卡尔曼滤波增益系数</span></span><br><span class="line">    X = X_ + K @ (Z - H @ X_)                    <span class="comment"># 计算最优估计值</span></span><br><span class="line">    P = (np.eye(<span class="number">2</span>) - K @ H ) @ P_                <span class="comment"># 更新最优估计协方差矩阵</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 记录结果</span></span><br><span class="line">    optim_positions[i] = X[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    optim_speeds[i] = X[<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line">    measure_positions[i] = Z[<span class="number">0</span>]</span><br><span class="line">    measure_speeds[i] = Z[<span class="number">1</span>]</span><br><span class="line">    </span><br><span class="line">t = np.concatenate((np.array([<span class="number">0</span>]), t))</span><br><span class="line">plt.plot(t,real_positions,label=<span class="string">'real positions'</span>)</span><br><span class="line">plt.plot(t,measure_positions,label=<span class="string">'measured positions'</span>)    </span><br><span class="line">plt.plot(t,optim_positions,label=<span class="string">'kalman filtered positions'</span>)</span><br><span class="line"></span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line">plt.plot(t,real_speeds,label=<span class="string">'real speeds'</span>)</span><br><span class="line">plt.plot(t,measure_speeds,label=<span class="string">'measured speeds'</span>)    </span><br><span class="line">plt.plot(t,optim_speeds,label=<span class="string">'kalman filtered speeds'</span>)</span><br><span class="line"></span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p>这段代码实现了一个一维匀加速运动中的<strong>卡尔曼滤波</strong>，用于估计物体的真实位置和速度。下面我们详细解释一下代码中每部分的含义，帮助你理解卡尔曼滤波的工作原理：</p>
<hr>
<h3 id="1-问题背景"><a class="markdownIt-Anchor" href="#1-问题背景"></a> <strong>1. 问题背景</strong></h3>
<ul>
<li>模拟的是一个匀加速直线运动的物体，其真实的运动受过程噪声（比如发动机噪声、风阻等）影响。</li>
<li>同时，测量设备（如 GPS 和 IMU）也会引入观测噪声，导致测量的位置和速度不够准确。</li>
<li>我们希望使用<strong>卡尔曼滤波</strong>方法，通过结合运动模型（预测值）和观测值，逐步估计物体的真实位置和速度。</li>
</ul>
<hr>
<h3 id="2-状态定义"><a class="markdownIt-Anchor" href="#2-状态定义"></a> <strong>2. 状态定义</strong></h3>
<p>状态包含两个变量：</p>
<ul>
<li>
<p>位置 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span></p>
<p>和</p>
<p>速度 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span></p>
<p>：</p>
<ul>
<li>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>=</mo><mo stretchy="false">[</mo><mi>x</mi><mi>v</mi><mo stretchy="false">]</mo><mi>X</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>x</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>v</mi></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mi>X</mi><mo>=</mo><mo stretchy="false">[</mo><mi>x</mi><mi>v</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">X=[xv]X = \begin{bmatrix} x \\ v \end{bmatrix}X=[xv]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault">x</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">]</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault">x</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">]</span></span></span></span></span></p>
</li>
</ul>
</li>
</ul>
<hr>
<h3 id="3-系统模型"><a class="markdownIt-Anchor" href="#3-系统模型"></a> <strong>3. 系统模型</strong></h3>
<ol>
<li>
<p><strong>状态转移模型 $$Xk+1=F⋅Xk+B⋅u+w$$</strong>：</p>
<ul>
<li>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mo>=</mo><mo stretchy="false">[</mo><mn>1101</mn><mo stretchy="false">]</mo><mi>F</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mi>F</mi><mo>=</mo><mo stretchy="false">[</mo><mn>1011</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">F=[1101]F = \begin{bmatrix} 1 &amp; 1 \\ 0 &amp; 1 \end{bmatrix}F=[1011]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mord">1</span><span class="mord">0</span><span class="mord">1</span><span class="mclose">]</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mord">0</span><span class="mord">1</span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span></p>
<p>：描述如何从当前的状态</p>
<p>XkX_kXk</p>
<p>预测下一时刻的状态。</p>
<ul>
<li>假设一个单位时间 Δt=1\Delta t = 1Δt=1，位置通过公式 xk+1=xk+vk⋅Δtx_{k+1} = x_k + v_k \cdot \Delta txk+1=xk+vk⋅Δt 预测。</li>
<li>速度保持不变：vk+1=vkv_{k+1} = v_kvk+1=vk。</li>
</ul>
</li>
<li>
<p>B=[1/21]B = \begin{bmatrix} 1/2 \ 1 \end{bmatrix}B=[1/21]</p>
<p>：控制矩阵，用于描述加速度对系统状态的影响。</p>
<ul>
<li>加速度 uuu 对位置的影响是 12uΔt2\frac{1}{2}u\Delta t^221uΔt2，对速度是 uΔtu\Delta tuΔt。</li>
</ul>
</li>
<li>
<p>www：过程噪声，用于模拟运动模型中的不确定性。</p>
</li>
</ul>
</li>
<li>
<p><strong>观测模型 Zk=H⋅Xk+vZ_k = H \cdot X_k + vZk=H⋅Xk+v</strong>：</p>
<ul>
<li>H=[1001]H = \begin{bmatrix} 1 &amp; 0 \ 0 &amp; 1 \end{bmatrix}H=[1001]：观测矩阵，表示测量设备直接观测位置和速度。</li>
<li>vvv：观测噪声，模拟测量设备的误差。</li>
</ul>
</li>
</ol>
<hr>
<h3 id="4-噪声和协方差矩阵"><a class="markdownIt-Anchor" href="#4-噪声和协方差矩阵"></a> <strong>4. 噪声和协方差矩阵</strong></h3>
<ul>
<li>
<p>过程噪声协方差矩阵 QQQ</p>
<p>：描述运动模型中的不确定性。</p>
<ul>
<li>Q=[100010]Q = \begin{bmatrix} 10 &amp; 0 \ 0 &amp; 10 \end{bmatrix}Q=[100010]：这里假设位置和速度上的过程噪声是独立的。</li>
</ul>
</li>
<li>
<p>观测噪声协方差矩阵 RRR</p>
<p>：描述测量设备的不准确性。</p>
<ul>
<li>R=[100000010000]R = \begin{bmatrix} 10000 &amp; 0 \ 0 &amp; 10000 \end{bmatrix}R=[100000010000]：这里假设位置和速度测量噪声也是独立的。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="5-卡尔曼滤波的步骤"><a class="markdownIt-Anchor" href="#5-卡尔曼滤波的步骤"></a> <strong>5. 卡尔曼滤波的步骤</strong></h3>
<p>卡尔曼滤波由两步组成：<strong>预测</strong> 和 <strong>更新</strong>。</p>
<h4 id="1-预测步骤"><a class="markdownIt-Anchor" href="#1-预测步骤"></a> <strong>(1) 预测步骤</strong></h4>
<ul>
<li>
<p><strong>状态预测</strong>：</p>
<p>Xk∣k−1=F⋅Xk−1∣k−1+B⋅uX_{k|k-1} = F \cdot X_{k-1|k-1} + B \cdot uXk∣k−1=F⋅Xk−1∣k−1+B⋅u</p>
<ul>
<li>利用状态转移方程，预测当前位置和速度。</li>
</ul>
</li>
<li>
<p><strong>协方差预测</strong>：</p>
<p>Pk∣k−1=F⋅Pk−1∣k−1⋅FT+QP_{k|k-1} = F \cdot P_{k-1|k-1} \cdot F^T + QPk∣k−1=F⋅Pk−1∣k−1⋅FT+Q</p>
<ul>
<li>协方差矩阵的预测，反映噪声和不确定性的传播。</li>
</ul>
</li>
</ul>
<h4 id="2-更新步骤"><a class="markdownIt-Anchor" href="#2-更新步骤"></a> <strong>(2) 更新步骤</strong></h4>
<ul>
<li>
<p><strong>卡尔曼增益</strong>：</p>
<p>Kk=Pk∣k−1⋅HT⋅(H⋅Pk∣k−1⋅HT+R)−1K_k = P_{k|k-1} \cdot H^T \cdot (H \cdot P_{k|k-1} \cdot H^T + R)^{-1}Kk=Pk∣k−1⋅HT⋅(H⋅Pk∣k−1⋅HT+R)−1</p>
<ul>
<li>卡尔曼增益决定了如何平衡预测值和观测值的权重。</li>
</ul>
</li>
<li>
<p><strong>状态更新</strong>：</p>
<p>Xk∣k=Xk∣k−1+Kk⋅(Zk−H⋅Xk∣k−1)X_{k|k} = X_{k|k-1} + K_k \cdot (Z_k - H \cdot X_{k|k-1})Xk∣k=Xk∣k−1+Kk⋅(Zk−H⋅Xk∣k−1)</p>
<ul>
<li>利用测量值 ZkZ_kZk，修正预测值。</li>
</ul>
</li>
<li>
<p><strong>协方差更新</strong>：</p>
<p>Pk∣k=(I−Kk⋅H)⋅Pk∣k−1P_{k|k} = (I - K_k \cdot H) \cdot P_{k|k-1}Pk∣k=(I−Kk⋅H)⋅Pk∣k−1</p>
<ul>
<li>更新后的协方差矩阵，用于描述估计值的不确定性。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="6-代码的具体实现"><a class="markdownIt-Anchor" href="#6-代码的具体实现"></a> <strong>6. 代码的具体实现</strong></h3>
<ol>
<li><strong>生成真实值和观测值</strong>：
<ul>
<li><code>X_true</code>：用运动模型生成真实位置和速度。</li>
<li><code>Z</code>：观测值通过添加观测噪声模拟。</li>
</ul>
</li>
<li><strong>卡尔曼滤波的预测和更新</strong>：
<ul>
<li><code>X_</code> 和 <code>P_</code>：预测状态和协方差矩阵。</li>
<li><code>K</code>：计算卡尔曼增益。</li>
<li><code>X</code> 和 <code>P</code>：更新状态和协方差矩阵。</li>
</ul>
</li>
<li><strong>记录结果</strong>：
<ul>
<li>用 <code>optim_positions</code> 和 <code>optim_speeds</code> 存储卡尔曼滤波的估计值。</li>
</ul>
</li>
</ol>
<hr>
<h3 id="7-图示结果"><a class="markdownIt-Anchor" href="#7-图示结果"></a> <strong>7. 图示结果</strong></h3>
<ul>
<li><strong>位置图</strong>：
<ul>
<li>蓝色：真实位置（<code>real_positions</code>）。</li>
<li>橙色：观测位置（<code>measure_positions</code>，带噪声）。</li>
<li>绿色：卡尔曼滤波估计的最优位置（<code>optim_positions</code>）。</li>
</ul>
</li>
<li><strong>速度图</strong>：
<ul>
<li>蓝色：真实速度（<code>real_speeds</code>）。</li>
<li>橙色：观测速度（<code>measure_speeds</code>，带噪声）。</li>
<li>绿色：卡尔曼滤波估计的最优速度（<code>optim_speeds</code>）。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="8-关键理解"><a class="markdownIt-Anchor" href="#8-关键理解"></a> <strong>8. 关键理解</strong></h3>
<ol>
<li><strong>噪声影响</strong>：
<ul>
<li>观测值受噪声影响波动较大。</li>
<li>卡尔曼滤波通过结合模型预测和观测值，显著减小噪声的影响。</li>
</ul>
</li>
<li><strong>滤波过程</strong>：
<ul>
<li>早期估计可能与真实值偏差较大，但随着时间推移，滤波器逐渐收敛。</li>
</ul>
</li>
<li><strong>卡尔曼增益的作用</strong>：
<ul>
<li>决定了如何在观测值和预测值之间取权重，观测噪声越大，越依赖模型预测。</li>
</ul>
</li>
</ol>
<hr>
<p>如果你对某一部分仍有疑问，可以详细提问，我会继续为你讲解！</p>
<h5 id="您说"><a class="markdownIt-Anchor" href="#您说"></a> 您说：</h5>
<p>为什么H是2x2的矩阵</p>
<h6 id="chatgpt-说"><a class="markdownIt-Anchor" href="#chatgpt-说"></a> ChatGPT 说：</h6>
<p>ChatGPT</p>
<p>在卡尔曼滤波中，观测矩阵 HHH 的维度是由状态向量 XXX 和观测向量 ZZZ 决定的，其大小为 m×nm \times nm×n，其中：</p>
<ul>
<li><strong>nnn</strong> 是状态向量的维度（这里是 2，因为状态 XXX 包括 [位置, 速度]）。</li>
<li><strong>mmm</strong> 是观测向量的维度（这里是 2，因为观测值 ZZZ 包括 [位置, 速度]）。</li>
</ul>
<p>代码中定义的状态向量和观测向量为：</p>
<ul>
<li>
<p><strong>状态向量 XXX</strong>：</p>
<p>X=[xv]X = \begin{bmatrix} x \ v \end{bmatrix}X=[xv]</p>
<p>包含两个变量：位置 xxx 和速度 vvv。</p>
</li>
<li>
<p><strong>观测向量 ZZZ</strong>：</p>
<p>Z=[zxzv]Z = \begin{bmatrix} z_x \ z_v \end{bmatrix}Z=[zxzv]</p>
<p>包含两个变量：测量的“位置” zxz_xzx 和测量的“速度” zvz_vzv。</p>
</li>
</ul>
<p>因此，观测矩阵 HHH 是一个 2×22 \times 22×2 的矩阵，用于从状态 XXX 映射到观测 ZZZ。形式为：</p>
<p>Z=H⋅X+vZ = H \cdot X + vZ=H⋅X+v</p>
<hr>
<h3 id="为什么-hhh-是-222-times-222-的单位矩阵"><a class="markdownIt-Anchor" href="#为什么-hhh-是-222-times-222-的单位矩阵"></a> 为什么 HHH 是 2×22 \times 22×2 的单位矩阵？</h3>
<p>在这个例子中，观测矩阵 HHH 被定义为：</p>
<p>H=[1001]H = \begin{bmatrix} 1 &amp; 0 \ 0 &amp; 1 \end{bmatrix}H=[1001]</p>
<p>这表示 <strong>观测值直接测量了状态中的位置和速度</strong>，且没有任何变换。具体来说：</p>
<ol>
<li>
<p><strong>第一行 [1,0][1, 0][1,0]</strong>：</p>
<ul>
<li>表示观测值的第一个分量 zxz_xzx 对应状态中的位置 xxx，并且它与速度 vvv 无关。</li>
</ul>
<p>zx=1⋅x+0⋅vz_x = 1 \cdot x + 0 \cdot vzx=1⋅x+0⋅v</p>
</li>
<li>
<p><strong>第二行 [0,1][0, 1][0,1]</strong>：</p>
<ul>
<li>表示观测值的第二个分量 zvz_vzv 对应状态中的速度 vvv，并且它与位置 xxx 无关。</li>
</ul>
<p>zv=0⋅x+1⋅vz_v = 0 \cdot x + 1 \cdot vzv=0⋅x+1⋅v</p>
</li>
</ol>
<p>这就说明测量设备可以分别直接得到位置和速度，且观测值和状态是一一对应的。</p>
<hr>
<h3 id="如果-hhh-不是单位矩阵怎么办"><a class="markdownIt-Anchor" href="#如果-hhh-不是单位矩阵怎么办"></a> 如果 HHH 不是单位矩阵怎么办？</h3>
<p>在实际应用中，观测值可能与状态变量不是一一对应的，比如：</p>
<ol>
<li>
<p><strong>观测值只有位置（没有速度）</strong>：</p>
<p>H=[10]H = \begin{bmatrix} 1 &amp; 0 \end{bmatrix}H=[10]</p>
<p>这里，观测值只包含位置 xxx，不包含速度 vvv。</p>
</li>
<li>
<p><strong>观测值是状态变量的某种线性组合</strong>：</p>
<p>H=[0.50.501]H = \begin{bmatrix} 0.5 &amp; 0.5 \ 0 &amp; 1 \end{bmatrix}H=[0.500.51]</p>
<p>这里，观测值的第一个分量是 0.5⋅x+0.5⋅v0.5 \cdot x + 0.5 \cdot v0.5⋅x+0.5⋅v，第二个分量是速度 vvv。</p>
</li>
<li>
<p><strong>非线性观测</strong>： 如果观测值和状态的关系是非线性的，可能需要使用扩展卡尔曼滤波（EKF）或无迹卡尔曼滤波（UKF）来处理。</p>
</li>
</ol>
<hr>
<h3 id="总结"><a class="markdownIt-Anchor" href="#总结"></a> 总结</h3>
<p>在这个例子中，观测矩阵 HHH 是一个 2×22 \times 22×2 的单位矩阵，因为：</p>
<ol>
<li>状态变量有 2 个（位置和速度），观测值也有 2 个（观测的位置和速度）。</li>
<li>观测值是状态变量的直接测量值，没有额外的变换或映射。</li>
</ol>
<p>这种设计简化了问题，但在实际中可能会根据具体传感器和系统特性定义更复杂的 HHH 矩阵。</p>
<h5 id="您说-2"><a class="markdownIt-Anchor" href="#您说-2"></a> 您说：</h5>
<ol start="4">
<li>噪声和协方差矩阵 过程噪声协方差矩阵  𝑄 Q：描述运动模型中的不确定性。 𝑄 = [ 10 0 0 10 ] Q=[  10 0 ​   0 10 ​ ]：这里假设位置和速度上的过程噪声是独立的。 观测噪声协方差矩阵  𝑅 R：描述测量设备的不准确性。 𝑅 = [ 10000 0 0 10000 ] R=[  10000 0 ​   0 10000 ​ ]：这里假设位置和 为什么是10和10000</li>
</ol>
<h6 id="chatgpt-说-2"><a class="markdownIt-Anchor" href="#chatgpt-说-2"></a> ChatGPT 说：</h6>
<p>ChatGPT</p>
<p>在卡尔曼滤波中，<strong>过程噪声协方差矩阵 Q</strong> 和 <strong>观测噪声协方差矩阵 RRR</strong> 是滤波器的重要参数，它们用来描述系统模型和测量设备的不确定性。你提到的值 $$ Q=[100010]Q = \begin{bmatrix} 10 &amp; 0 \ 0 &amp; 10 \end{bmatrix}Q=[100010] 和 R=[100000010000]R = \begin{bmatrix} 10000 &amp; 0 \ 0 &amp; 10000 \end{bmatrix}R=[100000010000] $$是人为设定的超参数，代表对过程噪声和观测噪声强度的假设。这些值的选择取决于应用场景中的经验或者对系统的具体了解。</p>
<hr>
<h3 id="1-为什么-qqq-是-10"><a class="markdownIt-Anchor" href="#1-为什么-qqq-是-10"></a> <strong>1. 为什么 QQQ 是 10</strong></h3>
<ul>
<li>
<p><strong>含义</strong>：QQQ 是<strong>过程噪声协方差矩阵</strong>，用于描述系统动态模型中的不确定性（即状态转移模型中可能的随机变化）。它反映了模型对自身预测的信任程度。</p>
</li>
<li>
<p><strong>设置为 10 的含义</strong>：</p>
<ul>
<li>
<p>在代码中，系统状态的两个变量是 [位置 xxx, 速度 vvv]。</p>
</li>
<li>
<p>设置</p>
<p>Q=[100010]Q = \begin{bmatrix} 10 &amp; 0 \ 0 &amp; 10 \end{bmatrix}Q=[100010]</p>
<p>表示：</p>
<ul>
<li>每秒钟，位置和速度的预测值可能会受到方差为 10 的噪声影响。</li>
<li>换句话说，假设运动模型存在较小的不确定性，因为 10 是一个适中的值（与观测噪声相比）。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>适用场景</strong>：这个值适合模拟一个较为简单、噪声较小的理想运动模型（例如匀加速运动），真实情况中可以根据实际系统的复杂程度调整。如果 QQQ 设得太小（接近 0），滤波器会过于相信模型而忽视观测值；如果设得太大，滤波器会对模型预测缺乏信任，可能过度依赖观测值。</p>
</li>
</ul>
<hr>
<h3 id="2-为什么-rrr-是-10000"><a class="markdownIt-Anchor" href="#2-为什么-rrr-是-10000"></a> <strong>2. 为什么 RRR 是 10000</strong></h3>
<ul>
<li>
<p><strong>含义</strong>：RRR 是<strong>观测噪声协方差矩阵</strong>，用于描述测量设备的不准确性（即传感器噪声）。它反映了测量值的可信度。</p>
</li>
<li>
<p><strong>设置为 10000 的含义</strong>：</p>
<ul>
<li>
<p>测量的两个变量是 [位置 xxx, 速度 vvv]。</p>
</li>
<li>
<p>设置</p>
<p>R=[100000010000]R = \begin{bmatrix} 10000 &amp; 0 \ 0 &amp; 10000 \end{bmatrix}R=[100000010000]</p>
<p>表示：</p>
<ul>
<li>测量设备（比如 GPS 或 IMU）在每次测量时的噪声方差为 10000。</li>
<li>这意味着测量设备相对不精确，观测数据波动较大。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>为什么观测噪声比过程噪声大很多</strong>：</p>
<ul>
<li>通常，测量设备引入的噪声（例如 GPS 的位置误差、IMU 的速度误差）比运动模型的内在不确定性大得多。</li>
<li>在本例中，将观测噪声方差设为 10000，远大于过程噪声方差 10，表示测量数据不太可信，卡尔曼滤波器会更多地依赖运动模型预测，而不是直接相信观测值。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="3-参数选择的本质"><a class="markdownIt-Anchor" href="#3-参数选择的本质"></a> <strong>3. 参数选择的本质</strong></h3>
<ol>
<li>
<p><strong>过程噪声协方差 QQQ</strong>：</p>
<ul>
<li>QQQ 反映了对系统模型中随机性或不确定性的假设。</li>
<li>如果系统模型非常精确，且外部干扰较小（例如恒定加速度运动），可以设定较小的 QQQ。</li>
<li>如果系统模型存在较多不确定性（例如非理想运动），可以设定较大的 QQQ。</li>
</ul>
</li>
<li>
<p><strong>观测噪声协方差 RRR</strong>：</p>
<ul>
<li>RRR 反映了对测量设备精度的假设。</li>
<li>如果测量设备非常精确（例如高精度 GPS 或激光雷达），可以设定较小的 RRR。</li>
<li>如果测量设备不够精确（例如普通 GPS 或低质量 IMU），应该设定较大的 RRR。</li>
</ul>
</li>
<li>
<p><strong>两者的相对大小</strong>：</p>
<ul>
<li>
<p>卡尔曼滤波器会根据</p>
<p>QQQ</p>
<p>和</p>
<p>RRR</p>
<p>的大小，动态调整对“模型预测值”和“测量值”的信任权重。</p>
<ul>
<li>如果 Q≪RQ \ll RQ≪R（过程噪声远小于观测噪声）：滤波器更相信运动模型的预测值。</li>
<li>如果 Q≫RQ \gg RQ≫R（过程噪声远大于观测噪声）：滤波器更依赖观测值，而弱化对模型的信任。</li>
</ul>
</li>
</ul>
</li>
</ol>
<hr>
<h3 id="4-为什么选-10-和-10000"><a class="markdownIt-Anchor" href="#4-为什么选-10-和-10000"></a> <strong>4. 为什么选 10 和 10000？</strong></h3>
<p>这些值是经验性的超参数，可以根据实际情况调整：</p>
<ul>
<li><strong>10</strong> 作为过程噪声的方差，假设运动模型有一定的不确定性，但这种不确定性较小，符合匀加速直线运动的理想模型。</li>
<li><strong>10000</strong> 作为观测噪声的方差，假设测量设备（例如 GPS 和 IMU）相对精度较低，观测数据波动较大。</li>
</ul>
<hr>
<h3 id="5-调整-qqq-和-rrr-的影响"><a class="markdownIt-Anchor" href="#5-调整-qqq-和-rrr-的影响"></a> <strong>5. 调整 QQQ 和 RRR 的影响</strong></h3>
<ol>
<li>如果增加 QQQ：
<ul>
<li>过程噪声增大，滤波器会更不信任模型预测，更依赖测量值。</li>
<li>结果可能会更接近观测值，但波动性会增加。</li>
</ul>
</li>
<li>如果增加 RRR：
<ul>
<li>观测噪声增大，滤波器会更不信任测量值，更依赖模型预测。</li>
<li>结果可能会更平滑，但与真实值的偏差可能会增加。</li>
</ul>
</li>
<li>如果 QQQ 和 RRR 都变小：
<ul>
<li>滤波器对模型和测量的信任都会增加，可能更快收敛，但对噪声的鲁棒性会降低。</li>
</ul>
</li>
<li>如果 QQQ 和 RRR 都变大：
<ul>
<li>滤波器对模型和测量都持较大怀疑态度，估计值可能会变得迟钝且收敛速度降低。</li>
</ul>
</li>
</ol>
<hr>
<h3 id="总结-2"><a class="markdownIt-Anchor" href="#总结-2"></a> <strong>总结</strong></h3>
<ul>
<li>QQQ 和 RRR 的值是根据应用场景和对系统的了解设定的。</li>
<li>在这个例子中：
<ul>
<li>Q=10Q = 10Q=10：假设运动模型的不确定性较小。</li>
<li>R=10000R = 10000R=10000：假设测量设备的噪声较大。</li>
</ul>
</li>
<li>这些值可以通过实验调整，以获得更好的滤波效果。如果你有真实数据，可以尝试调节这两个参数，观察滤波结果的变化！</li>
</ul>
<h5 id="您说-3"><a class="markdownIt-Anchor" href="#您说-3"></a> 您说：</h5>
<p>X_true = F @ X_true + B * u + w的结果？</p>
<h6 id="chatgpt-说-3"><a class="markdownIt-Anchor" href="#chatgpt-说-3"></a> ChatGPT 说：</h6>
<p>ChatGPT</p>
<p>在这段代码中，公式</p>
<p>Xtrue=F⋅Xtrue+B⋅u+wX_{\text{true}} = F \cdot X_{\text{true}} + B \cdot u + wXtrue=F⋅Xtrue+B⋅u+w</p>
<p>是用来模拟系统的真实状态更新的。下面我们具体分析其含义及结果。</p>
<hr>
<h3 id="1-符号解释"><a class="markdownIt-Anchor" href="#1-符号解释"></a> <strong>1. 符号解释</strong></h3>
<ul>
<li>
<p>Xtrue=[xv]X_{\text{true}} = \begin{bmatrix} x \ v \end{bmatrix}Xtrue=[xv]：表示系统的真实状态向量，包括位置 xxx 和速度 vvv。</p>
</li>
<li>
<p>F=[1101]F = \begin{bmatrix} 1 &amp; 1 \ 0 &amp; 1 \end{bmatrix}F=[1011]</p>
<p>：状态转移矩阵，用于描述理想的匀加速运动模型。</p>
<ul>
<li>第一行：预测位置 xxx 时，考虑到上一时刻的位置 xkx_kxk 和速度 vkv_kvk 的影响（假设时间步长为 1）。</li>
<li>第二行：速度 vvv 在匀加速运动中保持不变。</li>
</ul>
</li>
<li>
<p>B=[1/21]B = \begin{bmatrix} 1/2 \ 1 \end{bmatrix}B=[1/21]</p>
<p>：控制矩阵，描述加速度</p>
<p>uuu</p>
<p>对系统状态的影响。</p>
<ul>
<li>对位置 xxx：加速度的影响是 12u⋅Δt2\frac{1}{2} u \cdot \Delta t^221u⋅Δt2。</li>
<li>对速度 vvv：加速度的影响是 u⋅Δtu \cdot \Delta tu⋅Δt。</li>
</ul>
</li>
<li>
<p>uuu：加速度（设定为 0.6）。</p>
</li>
<li>
<p>www</p>
<p>：过程噪声（用随机数模拟的不确定性），表示真实运动状态的随机偏差。</p>
<ul>
<li>w=[wxwv]w = \begin{bmatrix} w_x \ w_v \end{bmatrix}w=[wxwv]：过程噪声对位置 xxx 和速度 vvv 的影响。</li>
<li>wx∼N(0,Q[0,0])w_x \sim \mathcal{N}(0, Q[0, 0])wx∼N(0,Q[0,0])：位置噪声的标准差是 Q[0,0]\sqrt{Q[0, 0]}Q[0,0]。</li>
<li>wv∼N(0,Q[1,1])w_v \sim \mathcal{N}(0, Q[1, 1])wv∼N(0,Q[1,1])：速度噪声的标准差是 Q[1,1]\sqrt{Q[1, 1]}Q[1,1]。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="2-更新过程"><a class="markdownIt-Anchor" href="#2-更新过程"></a> <strong>2. 更新过程</strong></h3>
<p>每一步的真实状态 XtrueX_{\text{true}}Xtrue 是通过以下公式计算的：</p>
<p>Xtrue=F⋅Xtrue+B⋅u+wX_{\text{true}} = F \cdot X_{\text{true}} + B \cdot u + wXtrue=F⋅Xtrue+B⋅u+w</p>
<p>逐项展开公式：</p>
<ol>
<li>
<p><strong>位置更新</strong>：</p>
<p>xtrue,new=xtrue+vtrue+12u+wxx_{\text{true,new}} = x_{\text{true}} + v_{\text{true}} + \frac{1}{2} u + w_xxtrue,new=xtrue+vtrue+21u+wx</p>
<ul>
<li>原位置 xtruex_{\text{true}}xtrue。</li>
<li>加上速度 vtruev_{\text{true}}vtrue 的影响（假设时间步长为 1）。</li>
<li>加上加速度 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span></span></span></span> 对位置的影响。</li>
<li>加上噪声 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">w_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。</li>
</ul>
</li>
<li>
<p><strong>速度更新</strong>：</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>v</mi><mtext>true,new</mtext></msub><mo>=</mo><msub><mi>v</mi><mtext>true</mtext></msub><mo>+</mo><mi>u</mi><mo>+</mo><msub><mi>w</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">v_{\text{true,new}} = v_{\text{true}} + u + w_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28055599999999997em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">true,new</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">true</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">u</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li>原速度 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>v</mi><mtext>true</mtext></msub></mrow><annotation encoding="application/x-tex">v_{\text{true}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">true</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。</li>
<li>加上加速度 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span></span></span></span> 对速度的影响。</li>
<li>加上噪声 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">w_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。</li>
</ul>
</li>
</ol>
<hr>
<h3 id="3-结果计算示例"><a class="markdownIt-Anchor" href="#3-结果计算示例"></a> <strong>3. 结果计算（示例）</strong></h3>
<p>假设当前的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mtext>true</mtext></msub><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>5</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">X_{\text{true}} = \begin{bmatrix} 0 \\ 5 \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">true</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span>，即当前位置为 0，速度为 5；加速度 u=0.6u = 0.6u=0.6，过程噪声<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mi>x</mi></msub><mo>∼</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>10</mn><mo stretchy="false">)</mo><mi mathvariant="normal">，</mi><msub><mi>w</mi><mi>v</mi></msub><mo>∼</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>10</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">w_x \sim \mathcal{N}(0, 10)，w_v \sim \mathcal{N}(0, 10)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mclose">)</span><span class="mord cjk_fallback">，</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mclose">)</span></span></span></span>。设生成的噪声值为：</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mi>x</mi></msub><mo>=</mo><mn>2.0</mn></mrow><annotation encoding="application/x-tex">w_x = 2.0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">.</span><span class="mord">0</span></span></span></span>（位置噪声）。</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mi>v</mi></msub><mo>=</mo><mo>−</mo><mn>1.0</mn></mrow><annotation encoding="application/x-tex">w_v = -1.0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">−</span><span class="mord">1</span><span class="mord">.</span><span class="mord">0</span></span></span></span>（速度噪声）。</li>
</ul>
<p>代入公式：</p>
<ol>
<li>
<p>位置更新：</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mtext>true,new</mtext></msub><mo>=</mo><mn>0</mn><mo>+</mo><mn>5</mn><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>⋅</mo><mn>0.6</mn><mo>+</mo><mn>2.0</mn><mo>=</mo><mn>0</mn><mo>+</mo><mn>5</mn><mo>+</mo><mn>0.3</mn><mo>+</mo><mn>2.0</mn><mo>=</mo><mn>7.3</mn></mrow><annotation encoding="application/x-tex">x_{\text{true,new}} = 0 + 5 + \frac{1}{2} \cdot 0.6 + 2.0 = 0 + 5 + 0.3 + 2.0 = 7.3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28055599999999997em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">true,new</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">6</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">.</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">.</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">7</span><span class="mord">.</span><span class="mord">3</span></span></span></span></p>
</li>
<li>
<p>速度更新：</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>v</mi><mtext>true,new</mtext></msub><mo>=</mo><mn>5</mn><mo>+</mo><mn>0.6</mn><mo>−</mo><mn>1.0</mn><mo>=</mo><mn>4.6</mn></mrow><annotation encoding="application/x-tex">v_{\text{true,new}} = 5 + 0.6 - 1.0 = 4.6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28055599999999997em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">true,new</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">6</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span><span class="mord">.</span><span class="mord">6</span></span></span></span></p>
</li>
</ol>
<p>最终结果：</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mtext>true,new</mtext></msub><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>7.3</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4.6</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">X_{\text{true,new}} = \begin{bmatrix} 7.3 \\ 4.6 \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28055599999999997em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">true,new</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">7</span><span class="mord">.</span><span class="mord">3</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span><span class="mord">.</span><span class="mord">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></p>
<hr>
<h3 id="4-真实状态的作用"><a class="markdownIt-Anchor" href="#4-真实状态的作用"></a> <strong>4. 真实状态的作用</strong></h3>
<p>在代码中，真实状态 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mtext>true</mtext></msub></mrow><annotation encoding="application/x-tex">X_{\text{true}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">true</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是用来生成模拟的“测量值”（加入测量噪声后得到的观测值）以及作为对比卡尔曼滤波效果的参考。<strong>真实状态不可直接观测</strong>，但其模拟有助于理解卡尔曼滤波的性能。</p>
<hr>
<h3 id="5-关键理解"><a class="markdownIt-Anchor" href="#5-关键理解"></a> <strong>5. 关键理解</strong></h3>
<ul>
<li>$F \cdot X_{\text{true}} $：根据理想模型更新状态。</li>
<li>$ B⋅uB \cdot uB⋅u $：考虑加速度对系统状态的影响。</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span></span>：引入随机噪声，模拟现实中模型的不确定性。</li>
</ul>
<p>最终的 $$X_{\text{true}}$$ 是理想模型、控制输入和随机过程噪声共同作用的结果。</p>
<h5 id="您说-4"><a class="markdownIt-Anchor" href="#您说-4"></a> 您说：</h5>
<p>卡尔曼滤波的英文</p>
<h6 id="chatgpt-说-4"><a class="markdownIt-Anchor" href="#chatgpt-说-4"></a> ChatGPT 说：</h6>
<p>ChatGPT</p>
<p>卡尔曼滤波的英文是 <strong>Kalman Filter</strong>。</p>
<p>以下是与卡尔曼滤波相关的一些常见术语及其英文：</p>
<ol>
<li><strong>状态向量 (State Vector)</strong>
<ul>
<li>描述系统状态的变量（例如位置、速度等）。</li>
</ul>
</li>
<li><strong>状态转移矩阵 (State Transition Matrix)</strong>
<ul>
<li><strong>F (State Transition Matrix)</strong>：描述系统状态从上一时刻到下一时刻如何演化的矩阵。</li>
</ul>
</li>
<li><strong>观测矩阵 (Observation Matrix)</strong>
<ul>
<li><strong>H (Observation Matrix)</strong>：将状态映射到测量值的矩阵。</li>
</ul>
</li>
<li><strong>过程噪声 (Process Noise)</strong>
<ul>
<li><strong>w (Process Noise)</strong>：描述系统模型中的随机不确定性。</li>
</ul>
</li>
<li><strong>观测噪声 (Measurement Noise)</strong>
<ul>
<li><strong>v (Measurement Noise)</strong>：描述测量值中的随机误差。</li>
</ul>
</li>
<li><strong>过程噪声协方差矩阵 (Process Noise Covariance Matrix)</strong>
<ul>
<li><strong>Q (Process Noise Covariance Matrix)</strong>：描述过程噪声的统计特性。</li>
</ul>
</li>
<li><strong>观测噪声协方差矩阵 (Measurement Noise Covariance Matrix)</strong>
<ul>
<li><strong>R (Measurement Noise Covariance Matrix)</strong>：描述观测噪声的统计特性。</li>
</ul>
</li>
<li><strong>卡尔曼增益 (Kalman Gain)</strong>
<ul>
<li><strong>K (Kalman Gain)</strong>：卡尔曼滤波中的权重，平衡预测值和观测值。</li>
</ul>
</li>
<li><strong>预测步骤 (Prediction Step)</strong>
<ul>
<li>在卡尔曼滤波中，用状态转移模型预测下一时刻的状态和协方差。</li>
</ul>
</li>
<li><strong>更新步骤 (Update Step)</strong>
<ul>
<li>利用观测值修正预测值，生成状态的最优估计。</li>
</ul>
</li>
</ol>
<p>卡尔曼滤波被广泛应用于控制系统、导航、信号处理和机器人等领域，用于融合预测模型和观测数据，降低噪声的影响，提供更准确的状态估计。</p>
<h5 id="您说-5"><a class="markdownIt-Anchor" href="#您说-5"></a> 您说：</h5>
<p>我要手动调节哪些参数</p>
<h6 id="chatgpt-说-5"><a class="markdownIt-Anchor" href="#chatgpt-说-5"></a> ChatGPT 说：</h6>
<p>ChatGPT</p>
<p>在卡尔曼滤波中，手动调节参数是关键的一步，它直接影响滤波器的性能和估计效果。以下是需要手动调节的关键参数，以及它们的意义和调整建议：</p>
<hr>
<h3 id="1-过程噪声协方差矩阵-q"><a class="markdownIt-Anchor" href="#1-过程噪声协方差矩阵-q"></a> <strong>1. 过程噪声协方差矩阵 (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Q</span></span></span></span>)</strong></h3>
<ul>
<li>
<p><strong>作用</strong>：描述系统模型中的不确定性，即状态变量（如位置和速度）随时间演变时引入的随机波动。</p>
</li>
<li>
<p><strong>代码中的定义</strong>：</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Q = np.array([[<span class="number">10</span>, <span class="number">0</span>], </span><br><span class="line">              [<span class="number">0</span>, <span class="number">10</span>]]) </span><br></pre></td></tr></tbody></table></figure>
<p>这里假设位置和速度的过程噪声是独立的，且方差均为 10。</p>
</li>
<li>
<p><strong>调整方法</strong>：</p>
<ul>
<li>
<p>增大 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Q</span></span></span></span></p>
<p>：</p>
<ul>
<li>表示对系统模型的不确定性较高，滤波器会更依赖观测值。</li>
<li>滤波器会更敏感，估计值可能波动较大，但适合系统变化较快的情况。</li>
</ul>
</li>
<li>
<p>减小 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Q</span></span></span></span></p>
<p>：</p>
<ul>
<li>表示对系统模型较为信任，滤波器会更依赖预测值。</li>
<li>滤波器更平滑，但可能无法快速响应系统的快速变化。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>建议</strong>：</p>
<ul>
<li>如果系统的加速度、速度变化较大，设置一个较大的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Q</span></span></span></span>。</li>
<li>如果系统比较稳定（如匀加速运动），则 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Q</span></span></span></span> 可以设置较小。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="2-观测噪声协方差矩阵-r"><a class="markdownIt-Anchor" href="#2-观测噪声协方差矩阵-r"></a> <strong>2. 观测噪声协方差矩阵 (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span>)</strong></h3>
<ul>
<li>
<p><strong>作用</strong>：描述测量设备的不确定性，即观测值中噪声的大小。</p>
</li>
<li>
<p><strong>代码中的定义</strong>：</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">R = np.array([[<span class="number">10000</span>, <span class="number">0</span>], </span><br><span class="line">              [<span class="number">0</span>, <span class="number">10000</span>]])</span><br></pre></td></tr></tbody></table></figure>
<p>这里假设测量噪声较大，位置和速度的测量误差独立，方差均为 10000。</p>
</li>
<li>
<p><strong>调整方法</strong>：</p>
<ul>
<li>
<p>增大 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span></p>
<p>：</p>
<ul>
<li>表示测量设备的精度较差，滤波器会更依赖系统模型的预测值。</li>
<li>滤波器估计值会更平滑，但可能与实际值偏差较大。</li>
</ul>
</li>
<li>
<p>减小 RRR</p>
<p>：</p>
<ul>
<li>表示测量设备的精度较高，滤波器会更依赖观测值。</li>
<li>滤波器估计值会更接近观测值，但波动会更大。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>建议</strong>：</p>
<ul>
<li>根据测量设备的精度选择合理的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span> 值。</li>
<li>对精度较高的设备（如高精度 GPS），可以设置较小的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span>。</li>
<li>对噪声较大的设备（如低成本 IMU），应设置较大的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span>。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="3-初始状态协方差矩阵-p"><a class="markdownIt-Anchor" href="#3-初始状态协方差矩阵-p"></a> <strong>3. 初始状态协方差矩阵 (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span>)</strong></h3>
<ul>
<li>
<p><strong>作用</strong>：描述对系统初始状态的不确定性。</p>
</li>
<li>
<p><strong>代码中的定义</strong>：</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">P = np.array([[<span class="number">0.1</span>, <span class="number">0</span>], </span><br><span class="line">              [<span class="number">0</span>, <span class="number">0.1</span>]])</span><br></pre></td></tr></tbody></table></figure>
<p>表示对初始位置和速度的置信度较高。</p>
</li>
<li>
<p><strong>调整方法</strong>：</p>
<ul>
<li>
<p>增大 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span></p>
<p>：</p>
<ul>
<li>表示对初始状态的不确定性较高，滤波器的收敛速度可能较慢。</li>
</ul>
</li>
<li>
<p>减小 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span></p>
<p>：</p>
<ul>
<li>表示对初始状态较为自信，滤波器可能会更快收敛，但容易偏离真实值。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>建议</strong>：</p>
<ul>
<li>如果对初始状态了解不多，设置一个较大的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span> 值。</li>
<li>如果对初始状态很自信（如已知初始位置和速度较准确），可以设置较小的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span> 值。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="4-控制输入-u-和控制矩阵-b"><a class="markdownIt-Anchor" href="#4-控制输入-u-和控制矩阵-b"></a> <strong>4. 控制输入 (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span></span></span></span>) 和控制矩阵 (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span>)</strong></h3>
<ul>
<li>
<p><strong>作用</strong>：控制输入描述系统受外力（如加速度）作用时的影响。控制矩阵 BBB 描述加速度对状态（位置和速度）的影响。</p>
</li>
<li>
<p><strong>代码中的定义</strong>：</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">u = <span class="number">0.6</span></span><br><span class="line">B = np.array([[<span class="number">1</span>/<span class="number">2</span>], </span><br><span class="line">              [<span class="number">1</span>]])</span><br></pre></td></tr></tbody></table></figure>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span></span></span></span>表示加速度，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span> 描述加速度对位置和速度的影响。</p>
</li>
<li>
<p><strong>调整方法</strong>：</p>
<ul>
<li>如果系统中的加速度已知（例如匀加速运动），设置一个精确的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span></span></span></span> 值。</li>
<li>如果加速度是未知的或不确定的，可以适当调整 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span></span></span></span> 或直接忽略控制输入。</li>
</ul>
</li>
<li>
<p><strong>建议</strong>：</p>
<ul>
<li>如果没有加速度信息，直接将 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi><mo>⋅</mo><mi>u</mi></mrow><annotation encoding="application/x-tex">B⋅u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span></span></span></span>设置为 0。</li>
<li>如果系统是匀加速运动，可以调整 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span></span></span></span> 以更好地拟合运动模型。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="5-时间步长-delta-t"><a class="markdownIt-Anchor" href="#5-时间步长-delta-t"></a> <strong>5. 时间步长 (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\Delta t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">Δ</span><span class="mord mathdefault">t</span></span></span></span>)</strong></h3>
<ul>
<li>
<p><strong>作用</strong>：决定状态转移矩阵 FFF 和控制矩阵 BBB 中的数值，影响状态更新的精度。</p>
</li>
<li>
<p><strong>代码中的默认值</strong>：假设时间步长为 1 秒。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">F = np.array([[<span class="number">1</span>, <span class="number">1</span>], </span><br><span class="line">              [<span class="number">0</span>, <span class="number">1</span>]])</span><br><span class="line">B = np.array([[<span class="number">1</span>/<span class="number">2</span>], </span><br><span class="line">              [<span class="number">1</span>]])</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>如果时间步长为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\Delta t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">Δ</span><span class="mord mathdefault">t</span></span></span></span>，状态转移矩阵和控制矩阵可以调整为： $$F = \begin{bmatrix} 1 &amp; \Delta t \ 0 &amp; 1 \end{bmatrix}, \quad B = \begin{bmatrix} \frac{\Delta t^2}{2} \ \Delta t \end{bmatrix}$$</li>
</ul>
</li>
<li>
<p><strong>调整方法</strong>：</p>
<ul>
<li>如果采样频率较高（如每 0.1 秒采样一次），需要调整 FFF 和 BBB 的数值。</li>
<li>对较慢的系统（如每 10 秒采样一次），需要增加时间步长。</li>
</ul>
</li>
<li>
<p><strong>建议</strong>：</p>
<ul>
<li>根据采样频率计算出准确的 Δt\Delta tΔt。</li>
<li>运动变化较快的系统使用较小的时间步长，较慢的系统可以适当增大。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="6-调节顺序和重点"><a class="markdownIt-Anchor" href="#6-调节顺序和重点"></a> <strong>6. 调节顺序和重点</strong></h3>
<p>调整卡尔曼滤波参数通常需要一些经验和实验，推荐以下顺序：</p>
<ol>
<li>
<p>确定初始状态和协方差矩阵 (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span>)</p>
<p>：</p>
<ul>
<li>初始值影响滤波器的收敛速度。</li>
</ul>
</li>
<li>
<p>调整观测噪声协方差矩阵 (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span>)</p>
<p>：</p>
<ul>
<li>根据传感器噪声水平调整 R$。</li>
<li>RRR 越大，越相信模型预测值；越小，越相信测量值。</li>
</ul>
</li>
<li>
<p>调整过程噪声协方差矩阵 (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Q</span></span></span></span>)</p>
<p>：</p>
<ul>
<li>根据运动模型的复杂性和系统的不确定性调整 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Q</span></span></span></span>。</li>
<li>QQQ 越大，越不相信模型预测值，滤波器对观测值更敏感。</li>
</ul>
</li>
<li>
<p>调整控制输入 (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span></span></span></span>) 和时间步长 (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\Delta t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">Δ</span><span class="mord mathdefault">t</span></span></span></span>)</p>
<p>：</p>
<ul>
<li>根据系统的实际情况和外部控制输入调整。</li>
</ul>
</li>
</ol>
<hr>
<h3 id="总结-3"><a class="markdownIt-Anchor" href="#总结-3"></a> <strong>总结</strong></h3>
<p>需要手动调节的关键参数：</p>
<ul>
<li><strong><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Q</span></span></span></span>：过程噪声协方差矩阵</strong>，反映运动模型的不确定性。</li>
<li><strong><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span>：观测噪声协方差矩阵</strong>，反映测量设备的不精确性。</li>
<li><strong><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span>：初始状态协方差矩阵</strong>，反映对初始状态的不确定性。</li>
<li><strong><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span></span></span></span>：加速度</strong>，描述外部控制输入的影响。</li>
<li><strong>$ \Delta t$：时间步长</strong>，影响状态转移矩阵和控制矩阵的设置。</li>
</ul>
<p>通过实验调整这些参数，你可以优化卡尔曼滤波器的性能，使其更好地适应特定的应用场景。如果有真实数据，还可以通过优化算法自动寻找最优参数。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://szturin.github.io">Szturin</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://szturin.github.io/posts/37796/">https://szturin.github.io/posts/37796/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://szturin.github.io" target="_blank">Turin's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://api.aqcoder.cn/random" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://unpkg.com/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://unpkg.com/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/56631/" title="【stm32单片机】32位单片机的引脚类型概念"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://api.aqcoder.cn/random" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">【stm32单片机】32位单片机的引脚类型概念</div></div></a></div><div class="next-post pull-right"><a href="/posts/20744/" title="【嵌入式】Clion开发工具链的部署"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://api.aqcoder.cn/random" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">【嵌入式】Clion开发工具链的部署</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Szturin</div><div class="author-info__description">保持热爱，奔赴星海</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">86</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">51</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">34</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Szturin"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">近期学习：1.stm32裸机开发-->rtos 2.python->OpenMv</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E7%8A%B6%E6%80%81%E7%A9%BA%E9%97%B4%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">1.</span> <span class="toc-text"> 1. 状态空间表达式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E7%B3%BB%E7%BB%9F%E6%A1%86%E5%9B%BE"><span class="toc-number">2.</span> <span class="toc-text"> 2. 系统框图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E9%AB%98%E6%96%AF%E5%88%86%E5%B8%83"><span class="toc-number">3.</span> <span class="toc-text"> 3. 高斯分布</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%8D%8F%E6%96%B9%E5%B7%AE"><span class="toc-number">4.</span> <span class="toc-text"> 4. 协方差</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E7%BB%B4%E5%8D%8F%E6%96%B9%E5%B7%AE"><span class="toc-number"></span> <span class="toc-text"> 二维协方差</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%8F%E6%96%B9%E5%B7%AE%E7%9F%A9%E9%98%B5%E7%9A%84%E8%A1%A8%E7%A4%BA"><span class="toc-number">1.</span> <span class="toc-text"> 协方差矩阵的表示</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E7%BB%B4%E5%8D%8F%E6%96%B9%E5%B7%AE%E7%9F%A9%E9%98%B5%E7%9A%84%E8%AE%A1%E7%AE%97"><span class="toc-number">2.</span> <span class="toc-text"> 二维协方差矩阵的计算</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%94%E7%94%A8"><span class="toc-number">3.</span> <span class="toc-text"> 应用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E8%B6%85%E5%8F%82%E6%95%B0"><span class="toc-number">4.</span> <span class="toc-text"> 5. 超参数</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%A1%E5%B0%94%E6%9B%BC%E6%BB%A4%E6%B3%A2"><span class="toc-number"></span> <span class="toc-text"> 卡尔曼滤波</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%A1%E5%B0%94%E6%9B%BC%E6%BB%A4%E6%B3%A2-2"><span class="toc-number"></span> <span class="toc-text"> 卡尔曼滤波</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E5%AE%9E%E7%8E%B0%E8%BF%87%E7%A8%8B"><span class="toc-number">1.</span> <span class="toc-text"> 一、实现过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%97%AE%E9%A2%98%E8%83%8C%E6%99%AF"><span class="toc-number">1.1.</span> <span class="toc-text"> 1. 问题背景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%8A%B6%E6%80%81%E5%AE%9A%E4%B9%89"><span class="toc-number">1.2.</span> <span class="toc-text"> 2. 状态定义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%B3%BB%E7%BB%9F%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.3.</span> <span class="toc-text"> 3. 系统模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%99%AA%E5%A3%B0%E5%92%8C%E5%8D%8F%E6%96%B9%E5%B7%AE%E7%9F%A9%E9%98%B5"><span class="toc-number">1.4.</span> <span class="toc-text"> 4. 噪声和协方差矩阵</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%8D%A1%E5%B0%94%E6%9B%BC%E6%BB%A4%E6%B3%A2%E7%9A%84%E6%AD%A5%E9%AA%A4"><span class="toc-number">1.5.</span> <span class="toc-text"> 5. 卡尔曼滤波的步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E9%A2%84%E6%B5%8B%E6%AD%A5%E9%AA%A4"><span class="toc-number">1.5.1.</span> <span class="toc-text"> (1) 预测步骤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%9B%B4%E6%96%B0%E6%AD%A5%E9%AA%A4"><span class="toc-number">1.5.2.</span> <span class="toc-text"> (2) 更新步骤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E4%BB%A3%E7%A0%81%E7%9A%84%E5%85%B7%E4%BD%93%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.6.</span> <span class="toc-text"> 6. 代码的具体实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E5%9B%BE%E7%A4%BA%E7%BB%93%E6%9E%9C"><span class="toc-number">1.7.</span> <span class="toc-text"> 7. 图示结果</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E5%85%B3%E9%94%AE%E7%90%86%E8%A7%A3"><span class="toc-number">1.8.</span> <span class="toc-text"> 8. 关键理解</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%82%A8%E8%AF%B4"><span class="toc-number">1.8.0.1.</span> <span class="toc-text"> 您说：</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#chatgpt-%E8%AF%B4"><span class="toc-number">1.8.0.1.1.</span> <span class="toc-text"> ChatGPT 说：</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88-hhh-%E6%98%AF-222-times-222-%E7%9A%84%E5%8D%95%E4%BD%8D%E7%9F%A9%E9%98%B5"><span class="toc-number">1.9.</span> <span class="toc-text"> 为什么 HHH 是 2×22 \times 22×2 的单位矩阵？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E6%9E%9C-hhh-%E4%B8%8D%E6%98%AF%E5%8D%95%E4%BD%8D%E7%9F%A9%E9%98%B5%E6%80%8E%E4%B9%88%E5%8A%9E"><span class="toc-number">1.10.</span> <span class="toc-text"> 如果 HHH 不是单位矩阵怎么办？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.11.</span> <span class="toc-text"> 总结</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%82%A8%E8%AF%B4-2"><span class="toc-number">1.11.0.1.</span> <span class="toc-text"> 您说：</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#chatgpt-%E8%AF%B4-2"><span class="toc-number">1.11.0.1.1.</span> <span class="toc-text"> ChatGPT 说：</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%B8%BA%E4%BB%80%E4%B9%88-qqq-%E6%98%AF-10"><span class="toc-number">1.12.</span> <span class="toc-text"> 1. 为什么 QQQ 是 10</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%B8%BA%E4%BB%80%E4%B9%88-rrr-%E6%98%AF-10000"><span class="toc-number">1.13.</span> <span class="toc-text"> 2. 为什么 RRR 是 10000</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%8F%82%E6%95%B0%E9%80%89%E6%8B%A9%E7%9A%84%E6%9C%AC%E8%B4%A8"><span class="toc-number">1.14.</span> <span class="toc-text"> 3. 参数选择的本质</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%80%89-10-%E5%92%8C-10000"><span class="toc-number">1.15.</span> <span class="toc-text"> 4. 为什么选 10 和 10000？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E8%B0%83%E6%95%B4-qqq-%E5%92%8C-rrr-%E7%9A%84%E5%BD%B1%E5%93%8D"><span class="toc-number">1.16.</span> <span class="toc-text"> 5. 调整 QQQ 和 RRR 的影响</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-2"><span class="toc-number">1.17.</span> <span class="toc-text"> 总结</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%82%A8%E8%AF%B4-3"><span class="toc-number">1.17.0.1.</span> <span class="toc-text"> 您说：</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#chatgpt-%E8%AF%B4-3"><span class="toc-number">1.17.0.1.1.</span> <span class="toc-text"> ChatGPT 说：</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%AC%A6%E5%8F%B7%E8%A7%A3%E9%87%8A"><span class="toc-number">1.18.</span> <span class="toc-text"> 1. 符号解释</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%9B%B4%E6%96%B0%E8%BF%87%E7%A8%8B"><span class="toc-number">1.19.</span> <span class="toc-text"> 2. 更新过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%BB%93%E6%9E%9C%E8%AE%A1%E7%AE%97%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.20.</span> <span class="toc-text"> 3. 结果计算（示例）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E7%9C%9F%E5%AE%9E%E7%8A%B6%E6%80%81%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">1.21.</span> <span class="toc-text"> 4. 真实状态的作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%85%B3%E9%94%AE%E7%90%86%E8%A7%A3"><span class="toc-number">1.22.</span> <span class="toc-text"> 5. 关键理解</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%82%A8%E8%AF%B4-4"><span class="toc-number">1.22.0.1.</span> <span class="toc-text"> 您说：</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#chatgpt-%E8%AF%B4-4"><span class="toc-number">1.22.0.1.1.</span> <span class="toc-text"> ChatGPT 说：</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%82%A8%E8%AF%B4-5"><span class="toc-number">1.22.0.2.</span> <span class="toc-text"> 您说：</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#chatgpt-%E8%AF%B4-5"><span class="toc-number">1.22.0.2.1.</span> <span class="toc-text"> ChatGPT 说：</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%BF%87%E7%A8%8B%E5%99%AA%E5%A3%B0%E5%8D%8F%E6%96%B9%E5%B7%AE%E7%9F%A9%E9%98%B5-q"><span class="toc-number">1.23.</span> <span class="toc-text"> 1. 过程噪声协方差矩阵 (QQQ)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%A7%82%E6%B5%8B%E5%99%AA%E5%A3%B0%E5%8D%8F%E6%96%B9%E5%B7%AE%E7%9F%A9%E9%98%B5-r"><span class="toc-number">1.24.</span> <span class="toc-text"> 2. 观测噪声协方差矩阵 (RRR)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%88%9D%E5%A7%8B%E7%8A%B6%E6%80%81%E5%8D%8F%E6%96%B9%E5%B7%AE%E7%9F%A9%E9%98%B5-p"><span class="toc-number">1.25.</span> <span class="toc-text"> 3. 初始状态协方差矩阵 (PPP)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%8E%A7%E5%88%B6%E8%BE%93%E5%85%A5-u-%E5%92%8C%E6%8E%A7%E5%88%B6%E7%9F%A9%E9%98%B5-b"><span class="toc-number">1.26.</span> <span class="toc-text"> 4. 控制输入 (uuu) 和控制矩阵 (BBB)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E6%97%B6%E9%97%B4%E6%AD%A5%E9%95%BF-delta-t"><span class="toc-number">1.27.</span> <span class="toc-text"> 5. 时间步长 (Δt\Delta tΔt)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E8%B0%83%E8%8A%82%E9%A1%BA%E5%BA%8F%E5%92%8C%E9%87%8D%E7%82%B9"><span class="toc-number">1.28.</span> <span class="toc-text"> 6. 调节顺序和重点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-3"><span class="toc-number">1.29.</span> <span class="toc-text"> 总结</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/12674/" title="【Markdown】数学公式入门"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://api.aqcoder.cn/random" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【Markdown】数学公式入门"/></a><div class="content"><a class="title" href="/posts/12674/" title="【Markdown】数学公式入门">【Markdown】数学公式入门</a><time datetime="2024-12-16T18:10:33.000Z" title="发表于 2024-12-17 02:10:33">2024-12-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/56631/" title="【stm32单片机】32位单片机的引脚类型概念"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://api.aqcoder.cn/random" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【stm32单片机】32位单片机的引脚类型概念"/></a><div class="content"><a class="title" href="/posts/56631/" title="【stm32单片机】32位单片机的引脚类型概念">【stm32单片机】32位单片机的引脚类型概念</a><time datetime="2024-12-16T17:59:25.000Z" title="发表于 2024-12-17 01:59:25">2024-12-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/37796/" title="【卡尔曼滤波】[1]理论基础入门"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://api.aqcoder.cn/random" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【卡尔曼滤波】[1]理论基础入门"/></a><div class="content"><a class="title" href="/posts/37796/" title="【卡尔曼滤波】[1]理论基础入门">【卡尔曼滤波】[1]理论基础入门</a><time datetime="2024-12-03T02:39:36.000Z" title="发表于 2024-12-03 10:39:36">2024-12-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/20744/" title="【嵌入式】Clion开发工具链的部署"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://api.aqcoder.cn/random" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【嵌入式】Clion开发工具链的部署"/></a><div class="content"><a class="title" href="/posts/20744/" title="【嵌入式】Clion开发工具链的部署">【嵌入式】Clion开发工具链的部署</a><time datetime="2024-11-14T09:08:36.000Z" title="发表于 2024-11-14 17:08:36">2024-11-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/50683/" title="【stm32单片机】[操作系统][RT-Thread][3]线程通信"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="/img/blog_cover/rt-thread.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【stm32单片机】[操作系统][RT-Thread][3]线程通信"/></a><div class="content"><a class="title" href="/posts/50683/" title="【stm32单片机】[操作系统][RT-Thread][3]线程通信">【stm32单片机】[操作系统][RT-Thread][3]线程通信</a><time datetime="2024-11-12T16:27:08.000Z" title="发表于 2024-11-13 00:27:08">2024-11-13</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2024 By Szturin</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a><br>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://static.dy208.cn/o_1dfilp8ruo521thr1hvf18ji17soa.png">
<a href="https://beian.miit.gov.cn/"  style="color:#f72b07" target="_blank">皖ICP备2024063708号</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://unpkg.com/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://unpkg.com/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"></div><script id="click-heart" src="https://unpkg.com/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="主题版本Butterfly" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站采用多线程部署，主线路托管于腾讯云服务器，备用线路托管于Github/Gitee。" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/loading.gif" data-original="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a></p>';
    console.log('已挂载butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><script async src="https://npm.elemecdn.com/hexo-butterfly-footer-beautify@1.0.0/lib/runtime.js"></script><!-- hexo injector body_end end -->
        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(r){r.imageLazyLoadSetting.processImages=t;var e=r.imageLazyLoadSetting.isSPA,n=r.imageLazyLoadSetting.preloadRatio||1,c=a();function a(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(){e&&(c=a());for(var t,o=0;o<c.length;o++)0<=(t=(t=c[o]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(r.innerHeight*n||document.documentElement.clientHeight*n)&&function(){var t,e,n,a,i=c[o];e=function(){c=c.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(n=new Image,a=t.getAttribute("data-original"),n.onload=function(){t.src=a,t.removeAttribute("data-original"),e&&e()},t.src!==a&&(n.src=a))}()}function i(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",i),r.addEventListener("resize",i),r.addEventListener("orientationchange",i)}(this);</script></body></html>